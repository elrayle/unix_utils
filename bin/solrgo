#! /bin/bash
ACTION="install"
case $1 in
    -h )
            echo '---------------------------'
            echo 'solr_wrapper startup script'
            echo '---------------------------'
            echo 'This script starts solr_wrapper for either ad hoc development through .internal_test app generated by `rake engine_cart:generate`'
            echo 'or for testing through rspec tests.'
            echo ''
            echo '-d start solr for ad hoc development testing through .internal_test app generated by `rake engine_cart:generate`'
            echo '-t start solr for testing through rspec tests'
            echo '-v start solr for valkyrie testing through rspec tests'
            echo '-h show these help instructions'
            exit
            ;;
    -n ) 
            echo '*** Starting SOLR in for nurax-pg ***'
            COL_NAME="nurax-pg"
            PORT="-p 8987"
            RUNPATH="$HOME/Services/solrnuraxpgdev"
            ;;
    -v ) 
            echo '*** Starting SOLR in VALKYRIE DEVELOPMENT mode ***'
            COL_NAME="hyrax-valkyrie-dev"
            PORT="-p 8988"
            RUNPATH="$HOME/Services/solrvalkryiedev"
            ;;
    -vt ) 
            echo '*** Starting SOLR in VALKYRIE TEST mode ***'
            COL_NAME="hyrax-valkyrie-test"
            PORT="-p 8989"
            RUNPATH="$HOME/Services/solrvalkryietest"
            ;;
    -e ) 
            echo '*** Starting SOLR in TEST mode for ESMIS ***'
            COL_NAME="hyrax-esmis-development"
            PORT="-p 8988"
            RUNPATH="$HOME/Services/solrvalkryietest"
            ;;
    -t ) 
            echo '*** Starting SOLR in TEST mode ***'
            COL_NAME="hydra-test"
            PORT="-p 8985"
            RUNPATH="$HOME/Services/solrtest"
            ;;
    -d | * )
            echo '*** Starting SOLR in DEVELOPMENT mode ***'
            COL_NAME="hydra-development"
            PORT=""
            RUNPATH="$HOME/Services/solrdev"
            ;;
esac

            COL="--collection_name $COL_NAME"
            echo "COL = $COL"
            RUNFILE="$RUNPATH/bin/solr"
            if [ -d "$RUNPATH" ] && [ -f "$RUNFILE" ]; then
              ACTION="run"
            fi

CMD="bundle exec solr_wrapper -d solr/conf/ $COL -i $RUNPATH $PORT"
echo "Will run command:  $CMD"
eval $CMD 

